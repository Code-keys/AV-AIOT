# <a href="https://gstreamer.freedesktop.org/documentation/plugin-development/index.html?gi-language=c"> 插件编写者指南 </a>

<details open>
<summary>介绍</summary>
<p> 
- 在本指南中，您将学习如何应用 特殊的 GStreamer 编程概念来编写一个简单的插件。 
</p> 
</details>

<details open>
<summary>创建 特殊 元素类型</summary>
<p> 

1.  基类 
    - 写一个水槽 
    - 编写源码
    - 编写转换元素

2. 编写解复用器或解析器 
    - 解复用器是需要特别小心的一对 N 元素。他们负责将原始的、未解析的数据标记为基本的视频或音频流，并且您可以优化或做错许多事情。在这里，将提到几个罪魁祸首，并提供常见的解决方案。解析器是只有一个源板的解复用器。此外，它们只将流切割成缓冲区，否则它们不会触及数据。

    - 正如前面在 Caps 协商中提到的，解复用器应该使用固定的上限，因为它们的数据类型不会改变。

    - 正如在不同的调度模式中所讨论的，分路器元素可以用多种方式编写：

    - 通过运行自己的任务，它们可以成为管道的驱动力。这对于需要随机访问的元素特别有效，例如 AVI 解复用器。

    - 它们还可以在基于推送的模式下运行，这意味着上游元素驱动管道。这对于可能来自网络的流特别有效，例如 Ogg。

    - 理论上，具有一个输出的音频解析器也可以以随机访问模式编写。虽然如果您的元素只接受一种模式，简单的播放将主要工作，但可能需要实现多种模式才能与各种应用程序结合使用，例如编辑。此外，如果您实现多种模式，性能可能会变得更好。请参阅不同的调度模式 以了解元素如何接受多种调度模式。

3. 编写 N 对 1 算子 或复用器 
    - N-to-1 元素之前已经在 Request 和有时 pads以及 不同的调度模式中提到和讨论过。关于 N-to-1 元素的主要值得注意的一点是，每个 pad 在其自己的线程中都是基于推送的，并且 N-to-1 元素通过基于预期时间戳的逻辑来同步这些流。这意味着它允许所有流等待，除了提供最早的下一个预期时间戳的流。当该流通过一个缓冲区时，将计算下一个最早的预期时间戳，然后我们从原来的位置开始，直到所有流都达到 EOS。有一个助手基类，叫做GstCollectPads，可以帮助你做到这一点。

    - 但是请注意，此帮助程序类只会帮助您从每个输入中获取一个缓冲区并为您提供具有最早时间戳的缓冲区。如果您需要更困难的事情，例如“在给定的时间戳之前不要抓取新缓冲区”或类似的东西，您需要自己做。

4. 编写管理器 
    - 管理器是添加功能或统一另一个（一系列）元素的功能的元素。经理通常是一个GstBin带有一个或多个 Ghostpad 的人。它们里面是/是重要的实际元素。在几种情况下这很有用。例如： 
        - 添加对具有自定义事件处理的私有事件的支持到另一个元素。 
        - 添加对自定义垫_query ()或_convert ()处理另一个元素的支持。 
        - 在另一个元素的数据处理函数（通常是它的_chain ()函数）之前或之后添加自定义数据处理。 
        - 将一个元素或一系列元素嵌入到在外部世界看起来和工作起来就像一个简单元素的东西中。这对于实现具有多个焊盘的源和接收器元素特别方便。 
    - 做一个经理就这么简单。您可以从 a 派生 Gst-Bin，并且在大多数情况下，您可以在其中嵌入所需的元素 _init ()，包括 Ghostpad 的设置。如果您需要任何自定义数据处理程序，您可以连接信号或嵌入您控制的第二个元素。

</p>  
</details>